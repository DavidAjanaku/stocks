/***********************************************
* DD Tab Menu script- &#169; Dynamic Drive DHTML code library
(www.dynamicdrive.com)
* This notice MUST stay intact for legal use
* Visit Dynamic Drive at http://www.dynamicdrive.com/ for full source code
***********************************************/

//Set tab to intially be selected when page loads:
//[which tab (1=first tab), ID of tab content to display (or "" if no corresponding tab content)]:
var IPOinitialtab=[1, "IPOsc1"]

//Turn menu into single level image tabs (completely hides 2nd level)?
var IPOturntosingle=0 //0 for no (default), 1 for yes

//Disable hyperlinks in 1st level tab images?
var IPOdisabletablinks=0 //0 for no (default), 1 for yes


////////Stop editting////////////////

var IPOprevioustab=""

if (IPOturntosingle==1)
document.write('<style type="text/css">\n#tabcontentcontainer{display:none;}\n</style>')

function expandIPOcontent(cid, aobject){
if (IPOdisabletablinks==1)
aobject.onclick=new Function("return false")
if (document.getElementById && IPOturntosingle==0){
highlighttab(aobject)
if (IPOprevioustab!="")
document.getElementById(IPOprevioustab).style.display="none"
if (cid!=""){
document.getElementById(cid).style.display="block"
IPOprevioustab=cid
}
}
}

function highlighttab(aobject){
if (typeof tabobjlinks=="undefined")
collectddtabs()
for (i=0; i<tabobjlinks.length; i++)
tabobjlinks[i].className=""
aobject.className="current"
}

function collectddtabs(){
var tabobj=document.getElementById("IPOtabs")
tabobjlinks=tabobj.getElementsByTagName("A")
}

function do_onload(){
initListGroup('categories', document.getElementById('IPOmain'), document.getElementById('IPOsub'));
if(document.getElementById('tabIPOcontentcontainer') != null)
{
collectddtabs()
expandIPOcontent(IPOinitialtab[1], tabobjlinks[IPOinitialtab[0]-1])
}
}

if (window.addEventListener)
window.addEventListener("load", do_onload, false)
else if (window.attachEvent)
window.attachEvent("onload", do_onload)
else if (document.getElementById)
window.onload=do_onload;



function swapIPO(obj)
{
  var val = obj[obj.selectedIndex].value;
  document.getElementById('CIR').style.display="none";
  document.getElementById('medInq').style.display="none";
  document.getElementById('orgRow').style.display="none";
  document.getElementById('orgRed').style.display="none";
  document.getElementById('IPOsel2').style.display="";
  if (val > 0)
 {document.getElementById('IPOsel2').style.display="none";}//   {document.getElementById('IPOsel').style.display="none";}
  if (val == 1)
    {document.getElementById('CIR').style.display="block";}
  if ((val == 2)||(val == 3))
  {
    document.getElementById('orgRow').style.display="";
    document.getElementById('orgRed').style.display="";
    document.getElementById('CIR').style.display="block";
  }
  if (val == 4)
    {document.getElementById('medInq').style.display="block";}
  if (val == 9)
  {
    document.getElementById('orgRow').style.display="";
    document.getElementById('CIR').style.display="block";
  } 
}

function resetIPO()
{
  var div = document.getElementById('CIR');
  var ins = div.getElementsByTagName('input');
  for (var i=0; i < ins.length; i++)
  {
    if ((ins[i].type != "radio")&&(ins[i].id != "IPOres")&&(ins[i].type != "submit")&&(ins[i].type != "hidden"))
      {ins[i].value="";}
  }
  var sels = div.getElementsByTagName('select');
  for (var s=0; s < sels.length; s++)
    {sels.value=0;}
  document.getElementById('IPOyes').checked="true";
  document.getElementById('IPOyes').checked="no";
  document.getElementById('IPOtxt').value="";
}

function chkIPO(obj)
{
	var type = document.getElementById('IPOtype');
	var val = type[type.selectedIndex].value;
	var error="";
	var main =  document.getElementById('IPOmain');
	var sub =  document.getElementById('IPOsub');
  if (main[main.selectedIndex].value == "")
	  {error+="Category: Please choose\n";}
  else if (sub[sub.selectedIndex].value == "")
	  {error+="Topic: Please choose\n";}
  if (((val == 2)||(val == 3))&&(document.getElementById('IPOorg').value == ""))
	  {error+="Organization Name: Please enter\n";}
  if (document.getElementById('IPOfn').value == "")
	  {error+="First Name: Please enter\n";}
  if (document.getElementById('IPOln').value == "")
	  {error+="Last Name: Please enter\n";}
  if (document.getElementById('IPOmail').value == "")
	  {error+="E-mail Address: Please enter\n";}
  else if (!(/[\d\w\.]+@[\d\w\.]/.test(document.getElementById('IPOmail').value)))
	  {error+="E-mail Address: Invalid adress\n";}
  if (document.getElementById('IPOconf').value == "")
	  {error+="Re-enter E-mail: Please enter\n";}
  else if (!(/[\d\w\.]+@[\d\w\.]/.test(document.getElementById('IPOconf').value)))
	  {error+="Re-enter E-mail: Invalid adress\n";}
  else if(document.getElementById('IPOmail').value != document.getElementById('IPOconf').value)
	  {error+="E-mail address: Confirm does not match, please re-enter\n";}
  if(document.getElementById('capta').value == "")
     {error+="Please enter the text you see in the image\n";}
  else if(!checkImg())
     {error+="The value entered for image verification does not match, please re-enter\n";}
  if (error != "")
  {
		error="Please fix the following required fields.\n\n"+error;
		alert(error);
		return false;
	}
  return true;
}

function refreshImg()
{
  var date=new Date();
  document.getElementById('capImg').src="image.php?regen=1&sys="+date.getTime(); 
}

function checkImg()
{
  var date=new Date(); 
  //append systime, to avoid cached file (IE/Safari).
  var url="chk.php?v="+document.getElementById('capta').value+"&sys="+date.getTime();
  var xmlhttp;

  if (window.XMLHttpRequest)
    {xmlhttp=new XMLHttpRequest;}
  else if (window.ActiveXObject)
    {xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}
  else
    {return true;}
  if (xmlhttp)
  {
    try
      {xmlhttp.open('GET', url, false);}
    catch(e)
    {
      var err=e.message ? e.message : e;
      return true;
    }
    xmlhttp.send(null);
    return eval(xmlhttp.responseText);
  }
  else
    { return true;}
}
